%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Operazioni sulle Descrizioni %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Operazioni sulle Descrizioni}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%   Visualizza Descrizione   %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Visualizzazione}
\begin{itemize}
	\item \textbf{Operazione}: visualizzaDescrizione
	\item \textbf{Obiettivo}: Visualizza la Descrizione di un'Opera, dato il suo IdDescr
	\item \textbf{Parametri}:
	\begin{enumerate}
		\item \textbf{idSessione}: in (da definire)
		\item \textbf{DescrID}: in number(5)
	\end{enumerate}
	\item \textbf{Risultato}: Visualizza i dettagli della Descrizione richiesta, altrimenti restituisce errore
	\item \textbf{Errori}: 
	\begin{itemize}
		\item La descrizione richiesta non è presente nella base di dati
	\end{itemize}
	\item \textbf{Usa}: Descrizioni
	\item \textbf{Modifica}: Descrizioni
	\item \textbf{Precondizioni}:
	\begin{itemize}
		\item $\exists x \in Descrizioni : x.IdDescr = DescrID$
	\end{itemize}
	\item \textbf{Postcondizioni}: nessuna
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%   Inserisci Descrizione   %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Inserimento}
\begin{itemize}
	\item \textbf{Operazione}: inserisciDescrizione
	\item \textbf{Obiettivo}: Inserisce una nuova descrizione, associandola ad un'Opera
	\item \textbf{Parametri}:
	\begin{enumerate}
		\item \textbf{idSessione}: in (da definire)
		\item \textbf{lingua}: in varchar2(25)
		\item \textbf{livello}: in varchar2(25)
		\item \textbf{testodescr}: in CLOB
		\item \textbf{OperaID}: in number(5)
	\end{enumerate}
	\item \textbf{Risultato}: Inserisce la descrizione dell'Opera, restituisce errore se l'Opera non è presente nel database
	\item \textbf{Errori}: 
	\begin{itemize}
		\item L'Opera a cui associare la descrizione non è presente nella base di dati
	\end{itemize}
	\item \textbf{Usa}: Descrizioni, Opere
	\item \textbf{Modifica}: Descrizioni
	\item \textbf{Precondizioni}:
	\begin{itemize}
		\item $\exists x \in Opere : x.IdOpera = OperaID$
	\end{itemize}
	\item \textbf{Postcondizioni}:
	\begin{itemize}
		\item $\exists x \in Descrizioni : x.Opera = OperaID \land x.Lingua = lingua \land x.Livello = livello \land x.Testo = testodescr$
	\end{itemize}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%    Modifica Descrizione    %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Modifica}
\begin{itemize}
	\item \textbf{Operazione}: ModificaDescrizione
	\item \textbf{Obiettivo}: Modifica la descrizione di un'opera (è possibile modificare anche l'opera a cui una descrizione è associata)
	\item \textbf{Parametri}:
	\begin{enumerate}
		\item \textbf{idSessione}: in (da definire)
		\item \textbf{descrID}: in number(5)
		\item \textbf{newlang}: in varchar2(25) default null
		\item \textbf{newlevel}: in varchar2(25) default null
		\item \textbf{newtext}: in CLOB default null
		\item \textbf{newOpera}: in number(5) default null
	\end{enumerate}
	\item \textbf{Risultato}: Modifica gli attributi della descrizione individuata da descrID, oppure ritorna un errore
	\item \textbf{Errori}: 
	\begin{itemize}
		\item La descrizione da modificare non è presente nella base di dati
		\item La nuova Opera da associare alla descrizione non è presente nella base di dati
	\end{itemize}
	\item \textbf{Usa}: Opere, Descrizioni
	\item \textbf{Modifica}: Descrizioni
	\item \textbf{Precondizioni}:
	\begin{itemize}
		\item $\exists x \in Descrizioni : x.IdDescr = descrID$
		\item $\exists x \in Opere : x.IdOpera = newOpera$
	\end{itemize}
	\item \textbf{Postcondizioni}:
	\begin{align*} (\exists x \in Descrizioni.
		& (newlang \ne null \Rightarrow x.Lingua = newlang) \\
		& \land (newlevel \ne null \Rightarrow x.Livello = newlevel) \\
		& \land (newtext \ne null \Rightarrow x.Testo = newtext) \\
		& \land (newOpera \ne null \Rightarrow x.Opera = newOpera))
	\end{align*}
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%   Rimozione Descrizione    %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Rimozione}
\begin{itemize}
	\item \textbf{Operazione}: rimuoviDesrizione
	\item \textbf{Obiettivo}: Rimuove una descrizione, se presente
	\item \textbf{Parametri}:
	\begin{enumerate}
		\item \textbf{idSessione}: in (da definire)
		\item \textbf{descrID}: in number(5)
	\end{enumerate}
	\item \textbf{Risultato}: Rimuove la descrizione dell'Opera, restituendo errore se la descrizione non è presente nel database
	\item \textbf{Errori}: 
	\begin{itemize}
		\item La Descrizione identificata da descrID non è presente nella base di dati
	\end{itemize}
	\item \textbf{Usa}: Descrizioni
	\item \textbf{Modifica}: Descrizioni
	\item \textbf{Precondizioni}:
	\begin{itemize}
		\item $\exists x \in Descrizioni : x.IdDescr = descrID$
		\item $|Descrizioni| = n$
	\end{itemize}
	\item \textbf{Postcondizioni}:
	\begin{itemize}
		\item $\nexists x \in Descrizioni : x.IdDescr = descrID$
		\item $|Descrizioni| = n - 1$
	\end{itemize}
\end{itemize}

\subsection{Statistiche e monitoraggio}
\subsubsection{Livello descrizione più presente}
\subsubsection{Lingua più presente}